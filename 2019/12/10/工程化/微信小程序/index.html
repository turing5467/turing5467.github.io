<!DOCTYPE html><html lang="cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 微信小程序 · 快乐的图小灵</title><meta name="description" content="微信小程序 - turing5467"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favi.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://turing5467.github.io/atom.xml" title="快乐的图小灵"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/logo.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">图小灵的博客</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="https://github.com/turing5467" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">微信小程序</h1><div class="post-info">Dec 10, 2019</div><div class="post-content"><h2 id="微信小程序"><a href="#微信小程序" class="headerlink" title="微信小程序"></a>微信小程序</h2><ul>
<li><p>微信小程序是腾讯于2017年1月9日推出的一种不需要下载安装即可在微信平台上使用的应用，主要提供给企业、政府、媒体、其他组织或 个人的开发者</p>
</li>
<li><p>本质与微信的原生功能应用是一样的–都是Web APP</p>
</li>
<li><p>优势</p>
<ol>
<li>开发适配成本低(推广APP的成本过高)</li>
<li>微信有海量用户，且粘性很高，在微信里开发产品更容易触达用户</li>
<li>容易小规模试错，然后快速迭代</li>
<li>跨平台</li>
</ol>
</li>
<li><p><a href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html" target="_blank" rel="noopener">文档</a></p>
</li>
</ul>
<h3 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h3><ol>
<li><p>注册账号：<a href="https://mp.weixin.qq.com/cgi-bin/registermidpage?action=index&lang=zh_CN&token=" target="_blank" rel="noopener">链接</a></p>
</li>
<li><p>获取APPId：<img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20191210153423531.png" alt="image-20191210153423531"></p>
</li>
</ol>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20191210153456694.png" alt="image-20191210153456694"></p>
<ol start="3">
<li><p>开发工具：微信开发者工具：<a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" target="_blank" rel="noopener">地址</a></p>
</li>
<li><p>调试页面</p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20191210160627943.png" alt="image-20191210160627943"></p>
</li>
</ol>
<h3 id="结构目录"><a href="#结构目录" class="headerlink" title="结构目录"></a>结构目录</h3><h4 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h4><table>
<thead>
<tr>
<th></th>
<th>传统web</th>
<th>小程序</th>
</tr>
</thead>
<tbody><tr>
<td>结构</td>
<td>HTML</td>
<td>WXML</td>
</tr>
<tr>
<td>表现</td>
<td>CSS</td>
<td>WXSS</td>
</tr>
<tr>
<td>行为</td>
<td>JS</td>
<td>JS</td>
</tr>
<tr>
<td>配置</td>
<td>无</td>
<td>JSON</td>
</tr>
</tbody></table>
<h4 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">pages/</span><br><span class="line">	index/</span><br><span class="line">		index.wxml</span><br><span class="line">		index.wxss</span><br><span class="line">		index.js</span><br><span class="line">	<span class="built_in">log</span>/</span><br><span class="line">		log.wxml</span><br><span class="line">		log.wxss</span><br><span class="line">		log.js</span><br><span class="line">		log.json	//<span class="built_in">log</span>页面相关配置</span><br><span class="line">utils/	//工具函数</span><br><span class="line">app.js	//入口文件 </span><br><span class="line">app.json	//小程序相关配置(如标题)</span><br><span class="line">app.wxss	//全局样式</span><br><span class="line">project.config.json	//开发者相关配置(类似于node的package.json)</span><br></pre></td></tr></table></figure>

<h4 id="app-json"><a href="#app-json" class="headerlink" title="app.json"></a>app.json</h4><ul>
<li><p>当前小程序的全局配置，包括小程序的所有页面路径、界面表现、网络超时时间，底部Tab。</p>
</li>
<li><p><a href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html" target="_blank" rel="noopener">文档</a></p>
</li>
<li><p>常用字段</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"pages"</span>: [		//用于指定小程序由哪些页面组成</span><br><span class="line">        <span class="string">"pages/index/index"</span>,	//第一项代表小程序的初始页面</span><br><span class="line">        <span class="string">"pages/log/log"</span>		//通过修改pages数组，增加/减少页面</span><br><span class="line">    ],</span><br><span class="line">    "window": &#123;		//用于设置小程序的状态栏、导航条、标题、窗口背景色。</span><br><span class="line">        "navigationBarBackgroundColor": "light",</span><br><span class="line">        "navigationBarTitleText": "标题"</span><br><span class="line">    &#125;,</span><br><span class="line">    "tabBar": &#123;		//tab栏的表现</span><br><span class="line">        "color": "#000",</span><br><span class="line">        "selectedColor": "#f23030",</span><br><span class="line">        "list": [	//最少2个，最多5个tab</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"pagePath"</span>: <span class="string">"pages/index/index"</span>,</span><br><span class="line">                <span class="attr">"text"</span>: <span class="string">"首页"</span>,</span><br><span class="line">                <span class="attr">"iconPath"</span>: <span class="string">"icons/index.png"</span>,</span><br><span class="line">                <span class="attr">"selectedIconPath"</span>: <span class="string">"icons/index_active.png"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            //...</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h4 id="json"><a href="#json" class="headerlink" title=".json"></a>.json</h4><ul>
<li><p><strong>每个页面</strong>独立定义的一些属性，这些属性只能设置app.json中部分window配置项的内容</p>
</li>
<li><p><a href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html#%E9%A1%B5%E9%9D%A2%E9%85%8D%E7%BD%AE" target="_blank" rel="noopener">文档</a></p>
</li>
</ul>
<h4 id="数据绑定"><a href="#数据绑定" class="headerlink" title="数据绑定"></a>数据绑定</h4><ul>
<li><p>wxml</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//index.wxml(无需引用js文件，直接使用变量)</span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">	&#123;&#123;msg&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">checkbox</span> <span class="attr">checked</span>=<span class="string">"&#123;&#123;false&#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">checkbox</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line">Page(&#123;</span><br><span class="line">    data: &#123;</span><br><span class="line">        msg: <span class="string">"Hello 小程序"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//修改数据：this.setData(&#123;&#125;)</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>循环（数组或对象）：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;view wx:<span class="keyword">for</span>=<span class="string">"&#123;&#123;arr&#125;&#125;"</span> wx:key=<span class="string">"&#123;&#123;index&#125;&#125;"</span> &gt;</span><br><span class="line">	&#123;&#123;index&#125;&#125; : &#123;&#123;item&#125;&#125;</span><br><span class="line">	&lt;!--</span><br><span class="line">    	index: 索引值/属性名，可通过wx:<span class="keyword">for</span>-item修改变量名</span><br><span class="line">		item: 属性值，可通过wx:<span class="keyword">for</span>-index修改变量名</span><br><span class="line">    --&gt;</span><br><span class="line">&lt;<span class="regexp">/view&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>条件渲染</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">"&#123;&#123;view == 'WEBVIEW'&#125;&#125;"</span>&gt;</span> WEBVIEW <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:elif</span>=<span class="string">"&#123;&#123;view == 'APP'&#125;&#125;"</span>&gt;</span> APP <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:else</span>=<span class="string">"&#123;&#123;view == 'MINA'&#125;&#125;"</span>&gt;</span> MINA <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>wxss</p>
<ul>
<li><p>引入外部样式：<code>@import &quot;相对路径/&quot;</code></p>
</li>
<li><p>内联样式：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">"background-color: yellow"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">"&#123;&#123;classObj&#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
</li>
</ul>
<ul>
<li><p>组件样式</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">view</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#194</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li><p>不支持通配符</p>
</li>
<li><p>推荐使用flex布局</p>
</li>
</ul>
<h4 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h4><ul>
<li><p><code>bindtap</code>：点击事件，默认参数为event</p>
</li>
<li><p><code>&#39;bind&#39;+&#39;xx&#39;</code>：对应冒泡事件</p>
</li>
<li><p><code>&#39;catch&#39;+&#39;xx&#39;</code>：对应非冒泡事件</p>
<blockquote>
<p>事件的值应当只是一个字符串，而不是一个函数引用</p>
</blockquote>
</li>
<li><p>传递参数：</p>
<ul>
<li>在标签中通过data-xx设置</li>
<li>在实践中通过<code>e.target/currentTarget.dataset.xx</code>获取数据</li>
</ul>
</li>
</ul>
<h4 id="生命周期？"><a href="#生命周期？" class="headerlink" title="生命周期？"></a>生命周期？</h4><h4 id="小程序适配方案"><a href="#小程序适配方案" class="headerlink" title="小程序适配方案"></a>小程序适配方案</h4><ul>
<li><strong>rpx（responsive pixel</strong>）: 可以根据屏幕宽度进行<strong>自适应</strong>。</li>
<li>iphone6: 1rpx = 1物理像素 = 0.5px</li>
<li>换算方式<ol>
<li>以iphone6的物理像素个数为标准：750</li>
<li>1rpx = 目标设备宽度/750 px</li>
<li>注意此时底层已经做了viewport适配的处理，即实现了理想视口</li>
</ol>
</li>
</ul>
<h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><blockquote>
<p>所有标签都必须闭合over</p>
</blockquote>
<h4 id="基础组件"><a href="#基础组件" class="headerlink" title="基础组件"></a>基础组件</h4><ul>
<li><p><code>&lt;view&gt;</code></p>
<ul>
<li><p><code>hover-class</code>属性指定<strong>按下</strong>时的样式类，为none时，为点击态效果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;view  class=&quot;nav-item &#123;&#123;index==curIndex?active:&quot;&quot;&#125;&#125;&quot; &gt;&lt;/view&gt;</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<ul>
<li><p><code>&lt;scroll-view&gt;</code></p>
<ul>
<li><code>scroll-x</code></li>
</ul>
</li>
<li><p><code>&lt;text&gt;</code></p>
<ul>
<li><code>selectable</code> 文本是否可选</li>
<li><code>space</code>显示连续空格</li>
<li><code>decode</code>是否解码</li>
</ul>
</li>
<li><p><code>&lt;image&gt;</code>图片标签（默认320×240），是web中img标签和背景图片的结合体</p>
<ul>
<li><p><code>src</code></p>
</li>
<li><p><code>lazy-load</code></p>
</li>
<li><p><code>mode</code></p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200105151957519.png" alt="image-20200105151957519"></p>
</li>
</ul>
</li>
</ul>
<ul>
<li><code>&lt;block&gt;</code>渲染一个无包裹元素的结构快</li>
</ul>
<h4 id="轮播图"><a href="#轮播图" class="headerlink" title="轮播图"></a>轮播图</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">swiper</span> <span class="attr">autoplay</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">swiper-item</span>&gt;</span> <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">"xx"</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span> <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">swiper-item</span>&gt;</span> <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">"xx"</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span> <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>·<code>swiper</code><ul>
<li><code>autoplay</code>、<code>interval</code>、<code>duration</code>、<code>current</code></li>
<li><code>circular</code>是否采用衔接滑动(最后一张接到第一张)</li>
<li><code>indicator-dots</code>、<code>indicator-color</code>、<code>indicator-active-color</code></li>
</ul>
</li>
</ul>
<h4 id="导航组件"><a href="#导航组件" class="headerlink" title="导航组件"></a>导航组件</h4><ul>
<li><code>navigator</code><ul>
<li><code>target</code> 在哪个目标上发生跳转，默认当前小程序 <pre><code>- self</code></pre><ul>
<li><code>url</code> 当前小程序内的跳转链接 </li>
</ul>
</li>
<li><code>open-type</code> 跳转方式<pre><code>- navigate、redirect、
     - switchTab、
         - reLaunch、navigateBack、exit</code></pre></li>
</ul>
</li>
</ul>
<h4 id="音视频"><a href="#音视频" class="headerlink" title="音视频"></a>音视频</h4><ul>
<li><p><code>&lt;video&gt;</code></p>
<ul>
<li>src、duration、autoplay、loop、muted</li>
</ul>
</li>
<li><p><code>&lt;audio&gt;</code></p>
</li>
</ul>
<h4 id="地图"><a href="#地图" class="headerlink" title="地图"></a>地图</h4><ul>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/component/map.html" target="_blank" rel="noopener">map</a></li>
</ul>
<h4 id="画布"><a href="#画布" class="headerlink" title="画布"></a>画布</h4><ul>
<li>canvas</li>
<li>相关API：<code>wx.createContext</code>、<code>wx.drawCanvas</code></li>
</ul>
<h4 id="自定义组件"><a href="#自定义组件" class="headerlink" title="自定义组件"></a>自定义组件</h4><ul>
<li><p>components文件夹 -&gt; 组建文件夹 -&gt; 输入组件名 -&gt; 自动生成四个对应文件</p>
</li>
<li><p>编写组件内容</p>
</li>
<li><p>引用组件：</p>
<ul>
<li><p>首先在页面中的json文件总进行引用声明，还要提供对应的组件名和路径</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"usingComponents"</span>: &#123;</span><br><span class="line">        //组件名：组件路径</span><br><span class="line">        "cpnName": "../../"</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>引用组件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">cpnName</span>&gt;</span><span class="tag">&lt;/<span class="name">cpnName</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><h4 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h4><h5 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h5><ul>
<li><code>wx.getSystemInfoSync()</code>获取系统信息的同步版本</li>
<li><code>wx.getSystemInfo()</code>获取系统信息，包括品牌、型号、相册、照相机权限等</li>
</ul>
<h5 id="小程序"><a href="#小程序" class="headerlink" title="小程序"></a>小程序</h5><ul>
<li><code>wx.getLaunchOptionsSync</code>：获取小程序启动时的参数，包括路径，场景值，query参数及来源信息</li>
<li><code>wx.getEnterOptionsSync</code>：同上</li>
</ul>
<h5 id="应用级事件"><a href="#应用级事件" class="headerlink" title="应用级事件"></a>应用级事件</h5><ul>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onUnhandledRejection.html" target="_blank" rel="noopener">wx.onUnhandledRejection</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onThemeChange.html" target="_blank" rel="noopener">wx.onThemeChange</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onPageNotFound.html" target="_blank" rel="noopener">wx.onPageNotFound</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onError.html" target="_blank" rel="noopener">wx.onError</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onAudioInterruptionEnd.html" target="_blank" rel="noopener">wx.onAudioInterruptionEnd</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onAudioInterruptionBegin.html" target="_blank" rel="noopener">wx.onAudioInterruptionBegin</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onAppShow.html" target="_blank" rel="noopener">wx.onAppShow</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onAppHide.html" target="_blank" rel="noopener">wx.onAppHide</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.offUnhandledRejection.html" target="_blank" rel="noopener">wx.offUnhandledRejection</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.offThemeChange.html" target="_blank" rel="noopener">wx.offThemeChange</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.offPageNotFound.html" target="_blank" rel="noopener">wx.offPageNotFound</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.offError.html" target="_blank" rel="noopener">wx.offError</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.offAudioInterruptionEnd.html" target="_blank" rel="noopener">wx.offAudioInterruptionEnd</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.offAudioInterruptionBegin.html" target="_blank" rel="noopener">wx.offAudioInterruptionBegin</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.offAppShow.html" target="_blank" rel="noopener">wx.offAppShow</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.offAppHide.html" target="_blank" rel="noopener">wx.offAppHide</a></li>
</ul>
<h5 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h5><ul>
<li><code>console</code></li>
</ul>
<h5 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h5><ul>
<li><code>setInterval</code>、<code>clearInterval</code></li>
<li><code>setTimeout</code>、<code>clearTimeout</code></li>
</ul>
<h5 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h5><ul>
<li><code>env</code></li>
</ul>
<h4 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h4><ul>
<li><code>wx.switchTab</code>： 跳转到 tabBar 页面，并关闭其他所有非 tabBar 页面 <ul>
<li>参数：<code>url</code>、<code>success</code>、<code>fail</code>、<code>complete</code></li>
</ul>
</li>
<li><code>wx.reLaunch</code>： 关闭所有页面，打开到应用内的某个页面 </li>
<li><code>wx.redirectTo</code>： 关闭当前页面，跳转到应用内的某个<code>非tabbar</code>页面。</li>
<li><code>wx.navigateTo</code>： 保留当前页面，跳转到应用内的某个<code>非tabbar</code>页面。</li>
<li><code>wx.navigateBack</code>： 关闭当前页面，返回上一页面或多级页面。可通过 <a href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/getCurrentPages.html" target="_blank" rel="noopener">getCurrentPages</a> 获取当前的页面栈，决定需要返回几层。 </li>
</ul>
<h4 id="界面"><a href="#界面" class="headerlink" title="界面"></a>界面</h4><ul>
<li><p><code>wx.showToast</code>：显示消息提示框</p>
</li>
<li><p>参数：<code>{title, icon, image, duration, mask, success, fail, complete}</code></p>
</li>
<li><p><code>wx.showModal</code>：显示模态对话框</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">wx.showModal(&#123;</span><br><span class="line">    title: <span class="string">'确认删除英雄？'</span>,</span><br><span class="line">    content: <span class="string">'你确认删除英雄吗，删除后不可恢复'</span>,</span><br><span class="line">    success(res) &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.confirm) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'用户点击确定'</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res.cancel) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'用户点击取消'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>wx.showLoading</code>：显示loading提示框， 需主动调用 <code>wx.hideLoading</code> 才能关闭提示框 </p>
</li>
<li><p><code>wx.showActionSheet</code>：显示操作菜单</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wx.showActionSheet(&#123;</span><br><span class="line">    itemList: [<span class="string">'苹果'</span>, <span class="string">'香蕉'</span>, <span class="string">'橙子'</span>],</span><br><span class="line">    success(res) &#123;</span><br><span class="line">        <span class="comment">// 点击按钮序号 0 1 2</span></span><br><span class="line">        <span class="built_in">console</span>.log(res.tapIndex)</span><br><span class="line">    &#125;,</span><br><span class="line">    fail(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res.errMsg)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>wx.showNavigationBarLoading({success})</code>显示导航栏加载图标</p>
<p>​    <code>wx.hideNavigationBarLoading</code>隐藏导航栏加载图标</p>
</li>
<li><p><code>wx.setNavigationBarTitle({title})</code>设置当前页面标题</p>
</li>
<li><p><code>wx.setNavigationBarColor({frontColor, backgroungColor, animation})</code></p>
</li>
<li><p><code>wx.showTabBarRedDot({index})</code>显示tab某一项右上角的红点(idnex从0开始)</p>
<ul>
<li><code>wx.hideTabBarRedDot({index})</code></li>
</ul>
</li>
<li><p><code>wx.setTabBarStyle({color, selectedColor, backgroundColor, borderStyle})</code>设置tabBar样式</p>
</li>
<li><p><code>wx.setTabBarBadge({index, text})</code>为 tabBar 某一项的右上角添加文本</p>
<p><code>wx.removeTabBarBadge({index})</code></p>
</li>
<li><p><code>wx.startPullDownRefresh</code>：触发下拉刷新动画（真机才起作用）</p>
</li>
<li><p><code>wx.pageScrollTo({scrollTop, duration, selector})</code>：将页面滚动到目标位置</p>
</li>
<li><p><code>wx.createAnimation({duration, timingFunction, delay, transformOrigin})</code>：创建一个动画示例。</p>
</li>
<li><p><code>wx.nextTick</code>： 延迟一部分操作到下一个<strong>时间片</strong>再执行。 </p>
</li>
<li><p><code>wx.onKeyboardHeightChange(callback)</code>：监听键盘高度变化回调</p>
<ul>
<li><code>wx.offKeyboardHeightChange</code>：取消监听</li>
</ul>
</li>
<li><p><code>wx.hideKeyBoard</code>：手动调用接口收起键盘</p>
</li>
</ul>
<h4 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h4><ul>
<li><code>wx.request({url, method, data, header, timeout, success})</code></li>
<li><code>wx.downloadFile({url, header, timeout, filePath})</code>：下载文件</li>
<li><code>wx.uploadFile({url, filePath, name, header, formData, timeout})</code>：上传文件</li>
<li><code>webSocket</code>协议<ul>
<li><code>wx.connectSocket</code>：连接ws</li>
<li><code>wx.sendSocketMessage</code>：通过ws发送数据</li>
<li><code>wx.closeSocket</code>：关闭ws</li>
<li><code>wx.onSocketOpen</code>：监听连接打开</li>
<li><code>wx.onSocketMessage</code></li>
<li><code>wx.onSocketError</code></li>
<li><code>wx.onSocketClose</code></li>
</ul>
</li>
</ul>
<h4 id="数据缓存"><a href="#数据缓存" class="headerlink" title="数据缓存"></a>数据缓存</h4><ul>
<li><p><code>wx.setStorage({key, data})</code>：数据存储至本地缓存（data 只支持原生类型、Date、及能够通过<code>JSON.stringify</code>序列化的对象。 ）</p>
<ul>
<li><code>wx.removeStorage({key})</code>：清楚指定key的本地缓存</li>
<li><code>wx.clearStorage</code>：清楚所有本地缓存</li>
</ul>
</li>
<li><p><code>wx.getStorage({key})</code>： 从本地缓存中异步获取指定 key 的内容 </p>
</li>
<li><p><code>wx.getStorageInfo</code>：获取当前storage的相关信息</p>
</li>
</ul>
<h4 id="媒体"><a href="#媒体" class="headerlink" title="媒体"></a>媒体</h4><ul>
<li><p>地图：</p>
</li>
<li><p>图片：</p>
<ul>
<li><p><code>wx.saveImageToPhotosAlbum({filePath})</code>：保存图片到系统相册</p>
</li>
<li><p><code>wx.previewMedia({sources, current})</code>：预览图片和视频</p>
</li>
<li><p><code>wx.previewImage({urls, current})</code>： 在新页面中全屏预览图片。预览的过程中用户可以进行保存图片、发送给朋友等操作。 </p>
</li>
<li><p><code>wx.getImageInfo({src, success})</code>：获取图片信息</p>
</li>
<li><p>success参数：width、height、path、orientation、type</p>
</li>
<li><p><code>wx.compressImage({src, quality})</code>压缩图片</p>
</li>
<li><p><code>wx.chooseMessageFile({count, type, extension})</code>： 从客户端会话选择文件。 </p>
</li>
<li><p><code>wx.chooseImage({count, sizeType, sourceType})</code>： 从本地相册选择图片或使用相机拍照。 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">onChangeAvatar()&#123;</span><br><span class="line">   wx.chooseImage(&#123;</span><br><span class="line">     count: <span class="number">1</span>,</span><br><span class="line">     sizeType: [<span class="string">'original'</span>, <span class="string">'compressed'</span>], <span class="comment">//正常或压缩</span></span><br><span class="line">     sourceType: [<span class="string">'album'</span>, <span class="string">'camera'</span>],  <span class="comment">// 照相机或相册</span></span><br><span class="line">     success: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">       <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">         avatarUrl: res.tempFilePaths[<span class="number">0</span>]</span><br><span class="line">         <span class="comment">// 该路径为临时路径，下一次进入小程序时无法访问</span></span><br><span class="line">         <span class="comment">// 如需访问，需要上传至服务器</span></span><br><span class="line">       &#125;)</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">image</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">class</span>=<span class="string">"userinfo-avatar"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">src</span>=<span class="string">"&#123;&#123;avatarUrl&#125;&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">bindtap</span>=<span class="string">"onChangeAvatar"</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">// 背景图貌似不起作用，所以换成src属性</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<ul>
<li><p>视频：</p>
<ul>
<li><code>wx.saveVideoToPhotosAlbum({filePath})</code>： 保存视频到系统相册。 </li>
<li><code>wx.openVideoEditor({filePath})</code>：打开视频编辑器</li>
<li><code>wx.getVideoInfo({src})</code>：获取视频详细信息</li>
<li><code>wx.createVideoContext</code>：</li>
<li><code>wx.compressVideo({src, quality,})</code>：压缩视频</li>
<li><code>wx.chooseVideo</code>：拍摄视频或从手机相册选视频</li>
<li><code>wx.chooseMedia</code>： 拍摄或从手机相册中选择图片或视频。 </li>
</ul>
</li>
<li><p>音频</p>
</li>
<li><p><code>wx.stopVoice</code>、<code>wx.playVoice</code>、<code>wx.pauceVoice</code></p>
</li>
<li><p>背景音乐</p>
<ul>
<li><p><code>wx.playBackgroundAudio</code>、<code>wx.pauseBackgroundAudio</code>、<code>wx.stopBackgroundAudio</code>、<code>wx.seekBackgroundAudio</code></p>
</li>
<li><p><code>wx.onBackgroundAudioStop</code>、<code>wx.onBackgroundAudioPlay</code>、<code>wx.onBackgroundAudioPauce</code></p>
</li>
<li><p><code>wx.getBackgroundAudioPlayerState</code>：获取后台音乐播放状态</p>
</li>
</ul>
</li>
<li><p>实时音视频？</p>
<ul>
<li><code>wx.createLivePusherContext</code></li>
<li><code>wx.createLivePlayerContext</code></li>
</ul>
</li>
<li><p>录音</p>
<ul>
<li><code>wx.startRecord({success(tempFilePath)})</code>：开始录音，超过一分钟或离开小程序自动结束录音</li>
<li><code>wx.stopRecord</code></li>
</ul>
</li>
<li><p>相机</p>
</li>
<li><p><code>wx.createCameraContext</code></p>
</li>
<li><p>富文本</p>
</li>
<li><p>音视频合成</p>
</li>
<li><p>实时语音</p>
</li>
<li><p>画面录制器</p>
</li>
<li><p>视频解码器</p>
</li>
</ul>
<h4 id="位置"><a href="#位置" class="headerlink" title="位置"></a>位置</h4><ul>
<li><code>wx.getLocation</code>：获取当前地理位置、速度。</li>
<li><code>wx.chooseLocation</code>：打开地图选择位置</li>
<li><code>wx.openLocation</code>： 使用微信内置地图查看位置 </li>
</ul>
<h4 id="转发"><a href="#转发" class="headerlink" title="转发"></a>转发</h4><h4 id="画布-1"><a href="#画布-1" class="headerlink" title="画布"></a>画布</h4><h4 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h4><ul>
<li><p><code>wx.saveFile</code>：保存文件到本地</p>
</li>
<li><p><code>wx.saveFileToDisk</code>：保存文件到磁盘，仅支持PC端</p>
</li>
<li><p><code>wx.getFileInfo</code></p>
</li>
</ul>
<h4 id="开放接口"><a href="#开放接口" class="headerlink" title="开放接口"></a>开放接口</h4><ul>
<li><p>登录</p>
<ul>
<li><code>wx.login</code>： 调用接口获取登录凭证（code）。  通过凭证进而换取用户登录态信息 。</li>
<li><code>wx.checkLogin</code>：检查登录态是否过期</li>
</ul>
</li>
<li><p>小程序跳转</p>
<ul>
<li><code>wx.navigateToMiniProgram({appId, path})</code>：打开一个小程序</li>
<li><code>wx.navigateBackMiniProgram({extraData})</code>： 返回到上一个小程序。  上一个小程序可在 <code>App.onShow</code> 中获取到<code>extraData</code>数据。 </li>
</ul>
</li>
<li><p>小程序信息</p>
<ul>
<li><code>wx.getAccountInfoSync</code></li>
</ul>
</li>
<li><p>授权</p>
<ul>
<li><p><code>wx.openSetting</code>：打开设置界面，引导用户开始授权</p>
</li>
<li><p><code>wx.getSetting</code>：获取授权状态</p>
</li>
<li><p><code>wx.auhtorize({scope, success})</code>：在调用需授权 API 之前，提前向用户发起授权请求。</p>
<blockquote>
<p> <code>wx.authorize({scope: &quot;scope.userInfo&quot;})</code>，不会弹出授权窗口，请使用 <code>&lt;button class=&quot;userinfo-nickname&quot;&gt;&lt;/button&gt;</code></p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"userinfo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> </span></span><br><span class="line"><span class="tag">           <span class="attr">class</span>=<span class="string">"userinfo-avatar"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">src</span>=<span class="string">"&#123;&#123;avatarUrl&#125;&#125;"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">bindtap</span>=<span class="string">"onChangeAvatar"</span></span></span><br><span class="line"><span class="tag">           &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"userinfo-nickname-wrapper"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"userinfo-nickname"</span> <span class="attr">bindtap</span>=<span class="string">"onGetOpenid"</span>&gt;</span>欢迎来到我的小程序<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">"getUserInfo"</span> <span class="attr">bindtap</span>=<span class="string">"getUserInfo"</span>&gt;</span>获取用户信息	<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">getUserInfo() &#123;</span><br><span class="line">    wx.getSetting(&#123;</span><br><span class="line">      success: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.authSetting[<span class="string">'scope.userInfo'</span>]) &#123;</span><br><span class="line">          wx.getUserInfo(&#123;</span><br><span class="line">            success: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">                avatarUrl: res.userInfo.avatarUrl</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
<p>  获取用户信息：<code>wx.getUserInfo</code></p>
<ul>
<li><p>支付</p>
</li>
<li><p>发起微信支付：<code>wx.requestPayment</code></p>
</li>
<li><p>地址</p>
<ul>
<li>获取用户收货地址：<code>wx.chooseAddress</code></li>
</ul>
</li>
<li><p>拉取 H5领取红包封面页</p>
<ul>
<li><code>wx.showRedPackage({url})</code></li>
</ul>
</li>
</ul>
<h3 id="云开发"><a href="#云开发" class="headerlink" title="云开发"></a>云开发</h3><ol>
<li>创建云开发环境</li>
</ol>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200507141711334.png" alt="image-20200507141711334"></p>
<ol start="2">
<li><p>cloudfunctions右键=&gt;更多设置=&gt; 指定项目环境</p>
</li>
<li><p>创建 =&gt; 编写云函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 云函数入口文件</span></span><br><span class="line"><span class="keyword">const</span> cloud = <span class="built_in">require</span>(<span class="string">'wx-server-sdk'</span>)</span><br><span class="line"></span><br><span class="line">cloud.init()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 云函数入口函数</span></span><br><span class="line">exports.main = <span class="keyword">async</span> (event, context) =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    sum: event.a + event.b</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>调用云函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wx.cloud.callFunction(&#123;</span><br><span class="line">  <span class="comment">// 云函数名称</span></span><br><span class="line">  name: <span class="string">'add'</span>,</span><br><span class="line">  <span class="comment">// 传给云函数的参数,服务端通过event.xx获取</span></span><br><span class="line">  data: &#123;&#125;,</span><br><span class="line">  success: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res.result.sum) <span class="comment">// 3</span></span><br><span class="line">  &#125;,</span><br><span class="line">  fail: <span class="built_in">console</span>.error</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


</li>
</ol>
<ol start="5">
<li>右键=&gt; 上传并部署所有文件</li>
</ol>
<h4 id="云函数操作数据库"><a href="#云函数操作数据库" class="headerlink" title="云函数操作数据库"></a>云函数操作数据库</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> db = cloud.database()</span><br><span class="line"></span><br><span class="line">exports.main = <span class="keyword">async</span> (event, context) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> db.collection(<span class="string">'Orders'</span>).add(&#123;</span><br><span class="line">    data: event,</span><br><span class="line">    success(res) &#123; <span class="comment">//成功打印消息</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'3'</span>, res)</span><br><span class="line">    &#125;,</span><br><span class="line">    fail(res) &#123; <span class="comment">//存入数据库失败</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'订单存入数据库操作失败'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    sum:event,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ap"><a href="#ap" class="headerlink" title="ap"></a>ap</h4></div></article></div></main><footer><div class="paginator"><a href="/2019/12/26/html-css/移动端布局/" class="prev">PREV</a><a href="/2019/11/11/js/库/styled-components/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'seansun';
var disqus_identifier = '2019/12/10/工程化/微信小程序/';
var disqus_title = '微信小程序';
var disqus_url = 'https://turing5467.github.io/2019/12/10/工程化/微信小程序/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//seansun.disqus.com/count.js" async></script><div class="copyright"><p>© 2019 - 2020 <a href="https://turing5467.github.io">turing5467</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>