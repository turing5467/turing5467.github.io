<!DOCTYPE html><html lang="cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Taro · 快乐的图小灵</title><meta name="description" content="Taro - turing5467"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favi.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://turing5467.github.io/atom.xml" title="快乐的图小灵"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/logo.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">图小灵的博客</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="https://github.com/turing5467" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Taro</h1><div class="post-info">Aug 23, 2020</div><div class="post-content"><h2 id="Taro"><a href="#Taro" class="headerlink" title="Taro"></a>Taro</h2><ul>
<li><p><strong>Taro</strong> 是一个开放式<strong>跨端跨框架</strong>解决方案 ，支持React、Vue等框架开发。</p>
</li>
<li><p>支持的终端</p>
<ul>
<li>微信小程序，百度/支付宝/字节跳动小程序、QQ轻应用</li>
<li>H5移动端Web页面（如微信小程序）</li>
<li>ReactNative（原生App）</li>
</ul>
</li>
<li><p>优点：一次开发、多端运行^.^</p>
<ol>
<li>编译多端：通过自身编译工具，编译成不同环境下的代码，实现多端运行</li>
<li>React语法规范：允许我们使用JSX和React相关的语法（包括Hooks）</li>
<li>组件开发：小程序的组件化并不是做的很好，使用Taro可以弥补这种不足</li>
<li>支持Typescript语法</li>
<li>开发流程自动化：使程序员集中精力在业务本身身上</li>
</ol>
</li>
</ul>
<h3 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h3><ol>
<li><p>安装Taro脚手架：<code>npm i -g @tarojs/cli</code> 或 <code>yarn global add @tarojs/cli</code></p>
</li>
<li><p>初始化一个项目：<code>taro init myDemo1</code></p>
<p>填写项目基本信息及配置</p>
</li>
<li><p>启用taro编译工具（热部署）：<code>yarn dev:h5</code></p>
<p><code>dev</code>表示开发模式</p>
<p>后缀表示编译模式：微信小程序后缀为<code>wxapp</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">微信：wxapp</span><br><span class="line">百度：swan</span><br><span class="line">支付宝：alipay</span><br><span class="line">H5: h5</span><br><span class="line">ReactNative：rn</span><br><span class="line">字节跳动：tt</span><br><span class="line">qq：qq</span><br><span class="line">快应用：quickapp</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="其它命令"><a href="#其它命令" class="headerlink" title="其它命令"></a>其它命令</h4><ol>
<li><p><code>taro update self</code>：更新到最新版本</p>
</li>
<li><p><code>taro doctor</code>：诊断项目的依赖、设置、结构，以及代码的规范是否存在问题，并尝试给出解决方案。</p>
</li>
<li><p><code>Taro create --name [页面名称]</code>：快速创建新页面</p>
</li>
<li><p>cli命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看用法</span></span><br><span class="line">$ taro config --<span class="built_in">help</span></span><br><span class="line"><span class="comment"># 设置配置项&lt;key&gt;的值为&lt;value&gt;</span></span><br><span class="line">$ taro config <span class="built_in">set</span> &lt;key&gt; &lt;value&gt;</span><br><span class="line"><span class="comment"># 读取配置项&lt;key&gt;</span></span><br><span class="line">$ taro config get &lt;key&gt;</span><br><span class="line"><span class="comment"># 删除配置项&lt;key&gt;</span></span><br><span class="line">$ taro config delete &lt;key&gt;</span><br><span class="line"><span class="comment"># 打印所有配置项</span></span><br><span class="line">$ taro config list [--json]</span><br></pre></td></tr></table></figure>







</li>
</ol>
<h4 id="taro-微信小程序"><a href="#taro-微信小程序" class="headerlink" title="taro-微信小程序"></a>taro-微信小程序</h4><ul>
<li><p>编译命令：``yarn dev:weapp`</p>
</li>
<li><p>预览小程序：打开微信开发者工具，选择项目的dist目录即可</p>
</li>
<li><p><a href="https://taro-docs.jd.com/taro/docs/GETTING-STARTED" target="_blank" rel="noopener">其它命令见</a></p>
</li>
</ul>
<h4 id="设计稿及尺寸单位"><a href="#设计稿及尺寸单位" class="headerlink" title="设计稿及尺寸单位"></a>设计稿及尺寸单位</h4><p><a href="https://taro-docs.jd.com/taro/docs/size" target="_blank" rel="noopener">文档</a></p>
<ul>
<li><p>Taro推荐使用<code>px</code>或<code>%</code>，因为在编译过程中会自动转换为<code>rpx</code>或<code>rem</code></p>
</li>
<li><p>Taro默认设计稿以750px为标准， 如果不是，则修改项目配置 <code>config/index.js</code> 中的 <code>designWidth</code>  即可。</p>
<p>不过也只默认支持640、750、828尺寸的设计稿</p>
</li>
<li><p>其它尺寸需要在<code>DEVICE_RATIO</code>中添加换算规则</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> DEVICE_RATIO = &#123;</span><br><span class="line">  <span class="string">'640'</span>: <span class="number">2.34</span> / <span class="number">2</span>,</span><br><span class="line">  <span class="string">'750'</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="string">'828'</span>: <span class="number">1.81</span> / <span class="number">2</span>,</span><br><span class="line">  <span class="string">'375'</span>: <span class="number">2</span> / <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>行内样式可使用<code>Taro.pxTransform (num)</code></p>
</li>
</ul>
<h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-config  // 项目配置</span><br><span class="line">-dist	 // 编译器生成的代码</span><br><span class="line">-src	 //项目源代码</span><br><span class="line">	-pages	//页面</span><br><span class="line">	app.js</span><br><span class="line">	app.less</span><br><span class="line">	app.config.js  	//项目配置，可以配置路由及项目样式，类似小程序的app.json</span><br><span class="line">.eslintrc</span><br><span class="line">.gitignore</span><br><span class="line">package.json  //项目包管理</span><br><span class="line">project.config.json  //项目配置文件</span><br></pre></td></tr></table></figure>

<h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><ul>
<li><p>组件使用：</p>
<ul>
<li>在小程序端， 可以使用所有的小程序原生组件 </li>
<li>H5端：需引入<code>@tarojs/components</code></li>
<li>RN端：需引入<code>@tarojs/components-rn</code></li>
</ul>
<p><code>import Tarp from &#39;@tarojs/taro&#39;</code></p>
</li>
<li><p>其他使用同React</p>
</li>
<li><p>图为使用Hooks的组件编写demo</p>
</li>
</ul>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200823195301698.png" alt="image-20200823195301698"></p>
<h4 id="事件传递"><a href="#事件传递" class="headerlink" title="事件传递"></a>事件传递</h4><h4 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h4><ul>
<li>如果是项目中的静态图片，不可直接使用路径，需要先引入图片</li>
<li>因为项目编译后图片的路径会发生改变</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nana <span class="keyword">from</span> <span class="string">'../../static/nana.jpg'</span></span><br><span class="line">&lt;Image src=&#123;nana&#125; width=<span class="string">"100px"</span> /&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h4><p><a href="https://taro-docs.jd.com/taro/docs/hooks" target="_blank" rel="noopener">链接</a></p>
<ul>
<li>在 Taro 中使用 Hooks API 很简单，Taro 的专有 Hooks（例如 <code>usePageScroll</code>, <code>useReachBottom</code>）从 <code>@tarojs/taro</code> 中引入，框架自己的 Hooks 从对应的框架引入。 </li>
</ul>
<ol>
<li><p><code>useDidShow</code>：等同于<code>componentDidShow</code>生命周期</p>
</li>
<li><p><code>useDidHide</code>：等同于<code>componentDidHide</code>生命周期</p>
</li>
<li><p><code>usePullDownRefresh</code>： 等同于 <code>onPullDownRefresh</code> 页面生命周期钩子 </p>
</li>
<li><p><code>useReachBottom</code>： 等同于 <code>onReachBottom</code> 页面生命周期钩子 </p>
</li>
<li><p><code>usePageScroll</code>： 等同于 <code>onPageScroll</code> 页面生命周期钩子 </p>
</li>
<li><p><code>useResize</code>： 等同于 <code>onResize</code> 页面生命周期钩子 </p>
</li>
<li><p><code>useShareAppMessage</code>： 等同于 <code>onShareAppMessage</code> 页面生命周期钩子 ，使用此 Hook 时必须在<code>page.config.js</code>配置<code>enableShareAppMessage: true</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Index</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  useShareAppMessage(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (res.from === <span class="string">'button'</span>) &#123;</span><br><span class="line">      <span class="comment">// 来自页面内转发按钮</span></span><br><span class="line">      <span class="built_in">console</span>.log(res.target)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      title: <span class="string">'自定义转发标题'</span>,</span><br><span class="line">      path: <span class="string">'/page/user?id=123'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// page.config.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  enableShareAppMessage: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="8">
<li><p><code>useTabItemTap</code>：等同于 <code>onTabItemTap</code> 页面生命周期钩子</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">useTabItemTap(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item.index)</span><br><span class="line">  <span class="built_in">console</span>.log(item.pagePath)</span><br><span class="line">  <span class="built_in">console</span>.log(item.text)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>useRouter</code></p>
</li>
<li><p><code>useReady</code>： 等同于页面的 <code>onReady</code> 生命周期钩子。 </p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">useTabItemTap(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item.index)</span><br><span class="line">  <span class="built_in">console</span>.log(item.pagePath)</span><br><span class="line">  <span class="built_in">console</span>.log(item.text)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





</li>
</ol>
<h3 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h3><ul>
<li>跳转：<ol>
<li><code>navigateTo({url})</code>： 保留当前页面，跳转到应用内的某个页面。但是不能跳到 tabbar 页面。 （若需要传参，参数写在url末尾）</li>
<li><code>redirectTo</code>： 关闭当前页面，跳转到应用内的某个页面。但是不允许跳转到 tabbar 页面。 </li>
<li><code>switchTab</code>：跳转到 tabBar 页面，并关闭其他所有非 tabBar 页面</li>
<li><code>navigateBack</code>：返回上级页面</li>
<li><code>relaunch</code>： 关闭所有页面，打开到应用内的某个页面 </li>
<li><code>getCurrentPages</code>：获取当前页面信息，H5不支持</li>
</ol>
</li>
</ul>
<blockquote>
<p> 小程序中页面栈最多十层。 </p>
</blockquote>
<ul>
<li>获路由参数：<code>this.$router.params.paramName</code></li>
</ul>
<h3 id="数据请求"><a href="#数据请求" class="headerlink" title="数据请求"></a>数据请求</h3><ul>
<li><code>Taro.request({url, })</code>：返回一个Promise对象，可以<code>then</code></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2020/08/30/Java/Java/" class="prev">PREV</a><a href="/2020/08/08/其他/上传文件流程/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'seansun';
var disqus_identifier = '2020/08/23/工程化/Taro/';
var disqus_title = 'Taro';
var disqus_url = 'https://turing5467.github.io/2020/08/23/工程化/Taro/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//seansun.disqus.com/count.js" async></script><div class="copyright"><p>© 2019 - 2020 <a href="https://turing5467.github.io">turing5467</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>