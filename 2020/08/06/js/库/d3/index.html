<!DOCTYPE html><html lang="cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> better-scroll · 快乐的图小灵</title><meta name="description" content="better-scroll - turing5467"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favi.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://turing5467.github.io/atom.xml" title="快乐的图小灵"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/logo.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">图小灵的博客</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="https://github.com/turing5467" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">better-scroll</h1><div class="post-info">Aug 6, 2020</div><div class="post-content"><p><a href="https://www.jianshu.com/p/48cfe84e655e" target="_blank" rel="noopener">参考文章</a></p>
<h2 id="D3"><a href="#D3" class="headerlink" title="D3"></a>D3</h2><ul>
<li><p>D3.JS就是一个数据可视化的库。<img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200806223702475.png" alt="star数92.7k"></p>
</li>
<li><p>类似库</p>
<ul>
<li>three.js：主要应用于基于webGL的<strong>3D</strong>场景，而D3主要应用于<strong>2D</strong>场景。<code>star数：62.6k</code></li>
<li>echarts：也是一个可视化库，<strong>封装</strong>了常规的折线图，柱状图，散点图，饼图，类似图标磨具，可以直接拿来使用。而D3就像画笔一样，一切都由你<strong>自由发挥</strong>。</li>
</ul>
</li>
<li><p>在我们的scrm系统中，经常需要数据统计，通常我们使用antd的Table组件来展示数据，对于某些数据来说，可能会不太直观,。</p>
</li>
</ul>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>D3.js通过预先创建好嵌入于网页中的JavaScript函数来选择网页元素、创建<strong>SVG</strong>元素、调整<code>CSS</code>来呈现数据，并且也可以设置动画、动态改变对象状态或加入工具提示来完成<strong>用户交互</strong>功能。</p>
<p>使用简单的D3.js函数就能够将大型的数据数据结构与<strong>SVG</strong>对象进行绑定，并且能生成<strong>格式化文本</strong>和各种<strong>图表</strong>。</p>
<h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>O.O<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>?.?<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://d3js.org/d3.v5.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        d3.selectAll(<span class="string">'body p'</span>).text(<span class="string">'Hello D3'</span>)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>选择元素：类似于jQuery的<code>$()</code></p>
<ul>
<li><p><code>select</code>： 选择所有指定元素的第一个 </p>
</li>
<li><p><code>selectAll</code>： 选择指定元素的全部 </p>
<p><img src="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200806225134076.png" alt="image-20200806225134076"></p>
</li>
</ul>
</li>
</ul>
<p>乍一看和jQuery没什么区别嘛，那我们接着往下看</p>
<h3 id="绑定数据"><a href="#绑定数据" class="headerlink" title="绑定数据"></a>绑定数据</h3><p> D3 有一个很独特的功能：能将数据绑定到 DOM 上 。</p>
<ul>
<li><code>datum(data)</code>：绑定一个数据（字符串、对象等）到选择集上</li>
<li><code>data(data)</code>绑定数组到选择集上</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>A<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>B<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>C<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://d3js.org/d3.v5.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> data = &#123;</span></span><br><span class="line"><span class="javascript">        name: <span class="string">'tr'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> p = d3.selectAll(<span class="string">'p'</span>)</span></span><br><span class="line">    p.datum(data)</span><br><span class="line"><span class="javascript">    p.text(<span class="function">(<span class="params">data,i</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="string">`我的名字叫<span class="subst">$&#123;data.name&#125;</span>`</span></span></span><br><span class="line">    &#125;)</span><br><span class="line">    data = [</span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">            name: <span class="string">'Apple'</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">            name: <span class="string">'banana'</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line"><span class="javascript">            name: <span class="string">'orange'</span></span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">    p.data(data)</span><br><span class="line"><span class="javascript">        .text(<span class="function">(<span class="params">ele, i</span>) =&gt;</span> <span class="string">`水果<span class="subst">$&#123;i+<span class="number">1</span>&#125;</span>号：<span class="subst">$&#123;ele.name&#125;</span>`</span>)</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>为选择集内每个元素末尾插入元素：<code>append()</code></p>
</li>
<li><p>为选择集内每个元素前插入元素：<code>insert()</code>（有差）</p>
</li>
<li><p>移除某元素：<code>remove()</code></p>
</li>
<li><p><code>enter()</code> 有数据，而没有足够图形元素的时候，使用此方法可以添加足够的元素。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>A<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>B<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>C<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://d3js.org/d3.v5.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> data = [<span class="string">'r'</span>, <span class="string">'o'</span>, <span class="string">'o'</span>, <span class="string">'k'</span>, <span class="string">'i'</span>, <span class="string">'e'</span>]</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 如果不加select('body')，下面append的元素会跑到body外面</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> p = d3.select(<span class="string">'body'</span>).selectAll(<span class="string">'p'</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">        p.data(data).enter().append(<span class="string">'p'</span>).text(<span class="function"><span class="params">d</span> =&gt;</span> d)</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>exit</code>：有元素，但没有足够数据时，使用此方法可以移除多余的元素</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>A<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>B<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>C<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> arr = [<span class="string">'r'</span>, <span class="string">'k'</span>]</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> div = d3.select(<span class="string">'body'</span>).selectAll(<span class="string">'div'</span>)</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 一定要写在text函数后面，不然元素数据不会改变</span></span></span><br><span class="line"><span class="javascript">        div.data(arr).text(<span class="function"><span class="params">d</span> =&gt;</span> d).exit().remove()</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="svg"><a href="#svg" class="headerlink" title="svg"></a>svg</h3><ul>
<li>前面提到d3能将大型数据与svg绑定在一起</li>
</ul>
<blockquote>
<p>SVG 指可伸缩矢量图形 (Scalable Vector Graphics)</p>
<p>SVG 用来定义用于网络的基于矢量的图形</p>
<p>SVG 使用 XML 格式定义图形</p>
<p><strong>SVG 图像在放大或改变尺寸的情况下其图形质量不会有所损失</strong></p>
</blockquote>
<ul>
<li>svg预定义的形状元素有：<code>rect</code>、<code>circle</code>、<code>ellipse</code>、<code>line</code>、<code>polyline(折线)</code>、<code>polygon(多边形)</code>、<code>path</code></li>
</ul>
<h4 id="使用d3绘制一个简单的柱形图"><a href="#使用d3绘制一个简单的柱形图" class="headerlink" title="使用d3绘制一个简单的柱形图"></a>使用d3绘制一个简单的柱形图</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://d3js.org/d3.v5.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> dataset = [<span class="number">250</span> , <span class="number">110</span> , <span class="number">170</span> ,<span class="number">230</span> , <span class="number">90</span>]</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> rectHeight = <span class="number">25</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> svg = d3.select(<span class="string">'body'</span>).select(<span class="string">'svg'</span>)</span></span><br><span class="line"><span class="javascript">        svg.selectAll(<span class="string">"rect"</span>)</span></span><br><span class="line">            .data(dataset)</span><br><span class="line">            .enter()</span><br><span class="line"><span class="javascript">            .append(<span class="string">"rect"</span>)</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"x"</span>, <span class="number">20</span>)</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"y"</span>, (d,i) =&gt; i * rectHeight)</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"width"</span>, d =&gt; d)</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"height"</span>, rectHeight<span class="number">-2</span>)</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"fill"</span>,<span class="string">"lightblue"</span>);</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="比例尺"><a href="#比例尺" class="headerlink" title="比例尺"></a>比例尺</h4><ul>
<li><p>直接用数值的大小来代表像素其实不是一种好方法，为什么呢</p>
</li>
<li><p>如果数值过大或过小，要么根本看不见，要么画布没有那么长</p>
</li>
<li><p>于是，我们需要一种计算关系，能够：</p>
<p><strong>将某一区域的值映射到另一区域，其大小关系不变。</strong></p>
</li>
<li><p>这就是<strong>比例尺</strong></p>
</li>
<li><p>d3提供了多种比例尺，下面介绍最常用的两种</p>
</li>
</ul>
<h5 id="线性比例尺"><a href="#线性比例尺" class="headerlink" title="线性比例尺"></a>线性比例尺</h5><ul>
<li><strong>将0，映射成 0；dataset最大的值，映射成 250。</strong> </li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://d3js.org/d3.v5.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> dataset = [<span class="number">2.5</span>, <span class="number">1.1</span>, <span class="number">1.7</span>,<span class="number">2.3</span>, <span class="number">0.9</span>]</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 为什么不将数组最小值赋值给min，因为最小值要映射为0，这样就看不见它了</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// let min = d3.min(dataset)</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> min = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> max = d3.max(dataset)</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 线形尺部分</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> linear = d3.scaleLinear()</span></span><br><span class="line">                        .domain([min, max])</span><br><span class="line">                        .range([0, 250])</span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> rectHeight = <span class="number">25</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> svg = d3.select(<span class="string">'body'</span>).select(<span class="string">'svg'</span>)</span></span><br><span class="line"><span class="javascript">        svg.selectAll(<span class="string">"rect"</span>)</span></span><br><span class="line">            .data(dataset)</span><br><span class="line">            .enter()</span><br><span class="line"><span class="javascript">            .append(<span class="string">"rect"</span>)</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"x"</span>, <span class="number">20</span>)</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"y"</span>, (d,i) =&gt; i * rectHeight)</span></span><br><span class="line"><span class="javascript">        	<span class="comment">// 通过线形尺映射width</span></span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"width"</span>, d =&gt; linear(d))</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"height"</span>, rectHeight<span class="number">-2</span>)</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"fill"</span>,<span class="string">"lightblue"</span>);</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="序数比例尺"><a href="#序数比例尺" class="headerlink" title="序数比例尺"></a>序数比例尺</h5><p> 有时候，定义域和值域不一定是连续的。例如，有两个数组： </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> index = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">var</span> color = [<span class="string">"red"</span>, <span class="string">"blue"</span>, <span class="string">"green"</span>, <span class="string">"yellow"</span>, <span class="string">"black"</span>];</span><br></pre></td></tr></table></figure>

<p> 我们希望 0 对应 red，1 对应 blue，依次类推。 </p>
<p> 这些值都是离散的，线性比例尺不适合，需要用到序数比例尺。 </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://d3js.org/d3.v5.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> dataset = [<span class="number">2.5</span>, <span class="number">1.1</span>, <span class="number">1.7</span>,<span class="number">2.3</span>, <span class="number">0.9</span>]</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> index = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> color = [<span class="string">"red"</span>, <span class="string">"blue"</span>, <span class="string">"green"</span>, <span class="string">"yellow"</span>, <span class="string">"black"</span>];</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> min = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> max = d3.max(dataset)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> linear = d3.scaleLinear()</span></span><br><span class="line">                        .domain([min, max])</span><br><span class="line">                        .range([0, 250])</span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> colorOrdinal = d3.scaleOrdinal()</span></span><br><span class="line">                            .domain(index)</span><br><span class="line">                            .range(color);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> rectHeight = <span class="number">25</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> svg = d3.select(<span class="string">'body'</span>).select(<span class="string">'svg'</span>)</span></span><br><span class="line"><span class="javascript">        svg.selectAll(<span class="string">"rect"</span>)</span></span><br><span class="line">            .data(dataset)</span><br><span class="line">            .enter()</span><br><span class="line"><span class="javascript">            .append(<span class="string">"rect"</span>)</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"x"</span>, <span class="number">20</span>)</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"y"</span>, (d,i) =&gt; i * rectHeight)</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 通过线形尺映射width</span></span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"width"</span>, d =&gt; linear(d))</span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"height"</span>, rectHeight<span class="number">-2</span>)</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 通过颜色映射尺映射颜色</span></span></span><br><span class="line"><span class="javascript">            .attr(<span class="string">"fill"</span>, (d, i) =&gt; colorOrdinal(i));</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="坐标轴"><a href="#坐标轴" class="headerlink" title="坐标轴"></a>坐标轴</h5><p>坐标轴，是可视化图表中经常出现的一种图形，由一些列线段和刻度组成。坐标轴在 SVG 中是没有现成的图形元素的，需要用其他的元素组合构成。</p>
<p>D3 提供了<strong>坐标轴的组件</strong>，如此在 SVG 画布中绘制坐标轴变得像添加一个普通元素一样简单。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> dataset = [<span class="number">2.5</span>, <span class="number">1.1</span>, <span class="number">1.7</span>,<span class="number">2.3</span>, <span class="number">0.9</span>]</span><br><span class="line"><span class="keyword">let</span> index = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> color = [<span class="string">"red"</span>, <span class="string">"blue"</span>, <span class="string">"green"</span>, <span class="string">"yellow"</span>, <span class="string">"black"</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> min = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> max = d3.max(dataset)</span><br><span class="line"><span class="keyword">let</span> linear = d3.scaleLinear()</span><br><span class="line">                .domain([min, max])</span><br><span class="line">                .range([<span class="number">0</span>, <span class="number">250</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> colorOrdinal = d3.scaleOrdinal()</span><br><span class="line">					.domain(index)</span><br><span class="line">					.range(color);</span><br><span class="line"><span class="comment">// 坐标轴</span></span><br><span class="line"><span class="keyword">let</span> axisX = d3.axisBottom(linear)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> rectHeight = <span class="number">25</span>;</span><br><span class="line"><span class="keyword">let</span> svg = d3.select(<span class="string">'body'</span>).select(<span class="string">'svg'</span>)</span><br><span class="line">svg.selectAll(<span class="string">"rect"</span>)</span><br><span class="line">    .data(dataset)</span><br><span class="line">    .enter()</span><br><span class="line">    .append(<span class="string">"rect"</span>)</span><br><span class="line">    .attr(<span class="string">"x"</span>, <span class="number">20</span>)</span><br><span class="line">    .attr(<span class="string">"y"</span>, (d,i) =&gt; i * rectHeight)</span><br><span class="line">	<span class="comment">// 通过线形尺映射width</span></span><br><span class="line">    .attr(<span class="string">"width"</span>, d =&gt; linear(d))</span><br><span class="line">    .attr(<span class="string">"height"</span>, rectHeight<span class="number">-2</span>)</span><br><span class="line">	<span class="comment">// 通过颜色映射尺映射颜色</span></span><br><span class="line">    .attr(<span class="string">"fill"</span>, (d, i) =&gt; colorOrdinal(i));</span><br><span class="line"><span class="comment">// 添加坐标轴</span></span><br><span class="line">svg.append(<span class="string">'g'</span>)</span><br><span class="line">    .attr(<span class="string">'transform'</span>, <span class="string">'translate(20,130)'</span>)</span><br><span class="line">    .call(axisX)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动态更新坐标轴数字</span></span><br><span class="line">d3.select(<span class="string">'#update'</span>).on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    linear.domain([<span class="number">0</span>, <span class="built_in">Math</span>.random() * <span class="number">100</span>]);</span><br><span class="line">    <span class="comment">// transition d3提供默认的动画</span></span><br><span class="line">    d3.select(<span class="string">'g'</span>).transition().call(axisX)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

</div></article></div></main><footer><div class="paginator"><a href="/2020/08/08/其他/上传文件流程/" class="prev">PREV</a><a href="/2020/07/26/其他/Gauge-Taiko/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'seansun';
var disqus_identifier = '2020/08/06/js/库/d3/';
var disqus_title = 'better-scroll';
var disqus_url = 'https://turing5467.github.io/2020/08/06/js/库/d3/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//seansun.disqus.com/count.js" async></script><div class="copyright"><p>© 2019 - 2020 <a href="https://turing5467.github.io">turing5467</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>